<font face="微软雅黑" size = 4 >
<style>
body{
line-height:3em;
}
</style>
# 直线拟合算法

## 为什么opencv的直线拟合算法不好用？
OpenCV中的fitLine的六种迭代方法都是是基于迭代最小二乘法的。它定义：点与直线在垂直方向上的距离为误差函数。但是在样本点的趋势接近垂直时，即使样本点离直线的空间距离很近，但是误差函数却很大，所以拟合效果不是很理想。

而在极片测量的项目中极片的边缘一般都是近似垂直或者水平，所以直接使用API效果不佳。

## 如何改进？
针对本项目中的直线拟合，可以在**Ransac算法**之后得到的粗略的直线角度，可以不通过迭代直接求解最优直线方程，减少计算时间。

* 当直线角度接近水平时，使用垂直方向上的距离作为误差函数；
* 当直线角度接近垂直时，使用水平方向上的距离作为误差函数；
* （扩展功能）其他角度可以将点集旋转到水平方向，通过最小二乘法求得直线后再将直线旋转回原始角度。（此方法会略微提高精度与时间，可以在时间与精度的平衡之间酌情考虑）